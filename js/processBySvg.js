var data1 = {
    name: "老总",
    msg: "XX军团老大,人数90W",
    data:[4.63,'4.63%','3.29%'],
    child: [
        {
            name: "1军长",
            msg: "第1军军长",
            data:[4.63,'4.63%','3.29%'],
            child: [
                {
                    name: "1师长", msg: "第1师师长",data:[4.63,'4.63%','3.29%'], child: [
                        {
                            name: "1团长", msg: "第1团团长", data:[4.63,'4.63%','3.29%'], child: []
                        }
                    ]
                },
                {
                    name: "2师长", msg: "第2师师长", data:[4.63,'4.63%','3.29%'], child: [{
                            name: "4团长", msg: "第1团团长", data:[4.63,'4.63%','3.29%'], child: []
                        },{
                            name: "5团长", msg: "第1团团长", data:[4.63,'4.63%','3.29%'], child: [
                                {
                                name: "45营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                },
                                {
                                name: "46营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                },
                                {
                                name: "47营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                }
                            ]
                        },{
                            name: "6团长", msg: "第1团团长", data:[4.63,'4.63%','3.29%'], child: [
                                {
                                name: "49营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                },
                                {
                                name: "50营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                },
                                {
                                name: "51营长", msg: "第1营营长", data:[4.63,'4.63%','3.29%'], child: []
                                }
                            ]
                        }]
                },
                {
                    name: "3师长", msg: "第3师师长", data:[4.63,'4.63%','3.29%'], child: [{
                            name: "7团长", msg: "第1团团长", data:[4.63,'4.63%','3.29%'], child: []
                        }]
                }
                ]
        },
        {
            name: "2军长",
            msg: "第2军军长",
            child: [
                {
                    name: "4师长", msg: "第4师师长", data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "5师长", msg: "第5师师长", data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "6师长", msg: "第6师师长", data:[4.63,'4.63%','3.29%'], child: []
                }
                ]
        },
        {
            name: "3军长",
            msg: "第3军军长",
            child: [
                {
                    name: "7师长", msg: "第7师师长", data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "8师长", msg: "第8师师长", data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "9师长", 
                    msg: "第9师师长", 
                    child: [
                        {
                            name: "113团长", msg: "第113团团长", data:[4.63,'4.63%','3.29%'], child: []
                        },
                        {
                            name: "114团长", msg: "第114团团长", data:[4.63,'4.63%','3.29%'], child: []
                        },
                        {
                            name: "115团长", msg: "第115团团长", data:[4.63,'4.63%','3.29%'], child: []
                        }
                    ]
                }
                ]
        }
    ]
}
var data2 = [{
    name: "总注册人数",
    msg: "",
    data:[4.63,'4.63%','3.29%'],
    child: [
        {
            name: "总在线人数",
            msg: "第1军军长",
            data:[4.63,'4.63%','3.29%'],
            child: [
                {
                    name: "总在线人数1", msg: "第1师师长",data:[4.63,'4.63%','3.29%'], child: [
                        {
                            name: "微信端日活跃人数", msg: "第1团团长",data:[4.63,'4.63%','3.29%'],  child: []
                        }
                    ]
                },
                {
                    name: "总在线人数2", msg: "第2师师长",data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "总在线人数3", msg: "第3师师长",data:[4.63,'4.63%','3.29%'], child: []
                }
                ]
        },
        {
            name: "日活跃人数",
            msg: "第2军军长",
            data:[4.63,'4.63%','3.29%'],
            child: [
                {
                    name: "日活跃人数1", msg: "日活跃人数1", data:[4.63,'4.63%','3.29%'],child: []
                },
                {
                    name: "日活跃人数2", msg: "日活跃人数2", data:[4.63,'4.63%','3.29%'],child: []
                },
                {
                    name: "日活跃人数3", msg: "日活跃人数3", data:[4.63,'4.63%','3.29%'],child: []
                }
                ]
        },
        {
            name: "日消费人数",
            msg: "第3军军长",
            data:[4.63,'4.63%','3.29%'],
            child: [
                {
                    name: "日消费人数1", msg: "日消费人数1",data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "日消费人数2", msg: "日消费人数2",data:[4.63,'4.63%','3.29%'], child: []
                },
                {
                    name: "日消费人数3",
                    msg: "第9师师长",
                    data:[4.63,'4.63%','3.29%'],
                    child: [
                        {
                            name: "流失人数1", msg: "第113团团长",data:[4.63,'4.63%','3.29%'], child: []
                        },
                        {
                            name: "流失人数2", msg: "第114团团长",data:[4.63,'4.63%','3.29%'], child: []
                        },
                        {
                            name: "流失人数3", msg: "第115团团长",data:[4.63,'4.63%','3.29%'], child: []
                        }
                    ]
                }
                ]
        }
    ]
}, {
    name: "总充值人数",
    msg: "XX军团副总,人数80W",
    data:[4.63,'4.63%','3.29%'],
    child: [
        {
            name: "消耗",
            msg: "第1军军长",
            data:[4.63,'4.63%','3.29%'],
            child: [
                {
                    name: "消耗1", msg: "第1师师长",data:[4.63,'4.63%','3.29%'], child: [
                        {
                            name: "流失人数", msg: "第1团团长",data:[4.63,'4.63%','3.29%'], child: []
                        }
                    ]
                },
                {
                    name: "消耗2", msg: "第2师师长", data:[4.63,'4.63%','3.29%'],child: []
                },
                {
                    name: "消耗3", msg: "第3师师长", data:[4.63,'4.63%','3.29%'],child: []
                }
                ]
        }]
}];
var procesvg = {
    svgHTMLS: ['<svg width="100%" height="100%" version="1.1" class="processvg">','</svg>'], 
    svg: null,
    create: function (options) {
        var control = new procesvg.control(options);
        return control;

    }
}

$(function () {
    var options = {
        data: data2,
        container: $('.main'),
        process: {
            //是否启用
            enable: false,
            //线类型 straightline,brokenline,pierreTline
            lineStyle: "straightline",
            //流程图节点遍历时,回调函数
            createChildFunc: function (data, points) {
                var rehtml = ''
                if (data.data) {
                    rehtml += '<tspan class="spanvalue prounitblue">' + data.data[0] + '</tspan><tspan class="prounit"> 千万</tspan>'
                            + '  ' + '<tspan class="spanm15">日环比: </tspan><tspan class="spanvalue prospanred">' + data.data[1] + '</tspan>'
                            + '  ' + '<tspan class="spanm15" x="' + (points.x) + '" y ="' + (points.y + 16) + '">周同比: </tspan><tspan class="spanvalue prospangreen">' + data.data[2] + '</tspan>';
                } else {
                    rehtml += '<tspan >' + data.msg + '</tspan>';
                }
                return rehtml;
            },
            //元素的坐标点重置时,回调函数
            resetPostionFunc: function (text, points) {
                text.find('tspan:eq(4)').attr('x', points.x).attr('y', points.y + 16);
            },
            imgSrc:'img/'
        },
        tree: {
            //是否启用
            enable: true,
            //树形菜单各节点遍历时,回调函数
            createChildFuc: function (data) {
                var htms = ['<div class="processtreelimsg"> ', '</div>'],
                    rehtml = htms[0]
                            + '<span class="prounitblue spanvalue">' + data.data[0] + '</span>' + '<span class="prounit" >千万</span>'
                            + '<span class="spanm15">日环比:</span>' + '<span class="prospanred spanvalue">' + data.data[1] + '</span>'
                            + '<span class="spanm15">周同比:</span>' + '<span class="prospangreen spanvalue">' + data.data[2] + '</span>'
                            + htms[1];

                return rehtml;
            }
        }

    }
    $('select[name="controlType"]').off().on('change', function () {
        var type = $(this).val();
        if (type === 'process') {
            options.process.enable = true;
            options.tree.enable = false;
            options.data = data1;
        } else {
            options.process.enable = false;
            options.tree.enable = true;
            options.data = data2;
        }
        window.a = procesvg.create(options);
    });
    $('select[name="processType"]').off().on('change', function () {
        var type = $(this).val();
        options.process.enable = true;
        options.tree.enable = false;
        options.process.lineStyle = type;
        options.data = data1;
        window.a = procesvg.create(options);
    });
    window.a = procesvg.create(options);
});